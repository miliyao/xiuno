<?php/* * 奇狐插件 配置文件 * QQ:77798085 */!defined('DEBUG') AND exit('Forbidden');plugin_info($plugins, $dir);include _include(APP_PATH.'plugin/fox_luckdraw/oddfox/model/luckdraw.func.php');$action = param(3);if(empty($action)){    if($method == 'GET'){        $get_luckdraw = kv_cache_get('fox_luckdraw');        $input = array();        $input['fox_freenum'] = form_text('fox_freenum', !empty($get_luckdraw['fox_freenum']) ? $get_luckdraw['fox_freenum'] : 0);        $input['fox_spintime'] = form_text('fox_spintime', !empty($get_luckdraw['fox_spintime']) ? $get_luckdraw['fox_spintime'] : 3);        $input['fox_rotates'] = form_text('fox_rotates', !empty($get_luckdraw['fox_rotates']) ? $get_luckdraw['fox_rotates'] : 4);        $input['fox_spinnum'] = form_text('fox_spinnum', !empty($get_luckdraw['fox_spinnum']) ? $get_luckdraw['fox_spinnum'] : 10);        $input['fox_expfees'] = form_text('fox_expfees', !empty($get_luckdraw['fox_expfees']) ? $get_luckdraw['fox_expfees'] : 5);        $input['choujs'] = form_text('choujs', !empty($get_luckdraw['choujs']) ? $get_luckdraw['choujs'] : 0);        $input['fox_exptype'] = form_select('fox_exptype', array('credits'=>'经验', 'golds'=>'金币', 'rmbs'=>'RMB', ), !empty($get_luckdraw['fox_exptype']) ? $get_luckdraw['fox_exptype'] : 'golds');        $input['fox_v1_name'] = form_text('fox_v1_name', !empty($get_luckdraw['fox_v1_name']) ? $get_luckdraw['fox_v1_name'] : '一等奖');        $input['fox_v1_ratio'] = form_text('fox_v1_ratio', !empty($get_luckdraw['fox_v1_ratio']) ? $get_luckdraw['fox_v1_ratio'] : 0);        $input['fox_v1_exps'] = form_text('fox_v1_exps', !empty($get_luckdraw['fox_v1_exps']) ? $get_luckdraw['fox_v1_exps'] : 25);        $input['fox_v1_type'] = form_select('fox_v1_type', array('credits'=>'经验', 'golds'=>'金币', 'rmbs'=>'RMB', ), !empty($get_luckdraw['fox_v1_type']) ? $get_luckdraw['fox_v1_type'] : 'golds');        $input['fox_v2_name'] = form_text('fox_v2_name', !empty($get_luckdraw['fox_v2_name']) ? $get_luckdraw['fox_v2_name'] : '二等奖');        $input['fox_v2_ratio'] = form_text('fox_v2_ratio', !empty($get_luckdraw['fox_v2_ratio']) ? $get_luckdraw['fox_v2_ratio'] : 0);        $input['fox_v2_exps'] = form_text('fox_v2_exps', !empty($get_luckdraw['fox_v2_exps']) ? $get_luckdraw['fox_v2_exps'] : 20);        $input['fox_v2_type'] = form_select('fox_v2_type', array('credits'=>'经验', 'golds'=>'金币', 'rmbs'=>'RMB', ), !empty($get_luckdraw['fox_v2_type']) ? $get_luckdraw['fox_v2_type'] : 'golds');        $input['fox_v3_name'] = form_text('fox_v3_name', !empty($get_luckdraw['fox_v3_name']) ? $get_luckdraw['fox_v3_name'] : '三等奖');        $input['fox_v3_ratio'] = form_text('fox_v3_ratio', !empty($get_luckdraw['fox_v3_ratio']) ? $get_luckdraw['fox_v3_ratio'] : 0);        $input['fox_v3_exps'] = form_text('fox_v3_exps', !empty($get_luckdraw['fox_v3_exps']) ? $get_luckdraw['fox_v3_exps'] : 15);        $input['fox_v3_type'] = form_select('fox_v3_type', array('credits'=>'经验', 'golds'=>'金币', 'rmbs'=>'RMB', ), !empty($get_luckdraw['fox_v3_type']) ? $get_luckdraw['fox_v3_type'] : 'golds');        $input['fox_v4_name'] = form_text('fox_v4_name', !empty($get_luckdraw['fox_v4_name']) ? $get_luckdraw['fox_v4_name'] : '四等奖');        $input['fox_v4_ratio'] = form_text('fox_v4_ratio', !empty($get_luckdraw['fox_v4_ratio']) ? $get_luckdraw['fox_v4_ratio'] : 0);        $input['fox_v4_exps'] = form_text('fox_v4_exps', !empty($get_luckdraw['fox_v4_exps']) ? $get_luckdraw['fox_v4_exps'] : 10);        $input['fox_v4_type'] = form_select('fox_v4_type', array('credits'=>'经验', 'golds'=>'金币', 'rmbs'=>'RMB', ), !empty($get_luckdraw['fox_v4_type']) ? $get_luckdraw['fox_v4_type'] : 'golds');        $input['fox_v5_name'] = form_text('fox_v5_name', !empty($get_luckdraw['fox_v5_name']) ? $get_luckdraw['fox_v5_name'] : '五等奖');        $input['fox_v5_ratio'] = form_text('fox_v5_ratio', !empty($get_luckdraw['fox_v5_ratio']) ? $get_luckdraw['fox_v5_ratio'] : 0);        $input['fox_v5_exps'] = form_text('fox_v5_exps', !empty($get_luckdraw['fox_v5_exps']) ? $get_luckdraw['fox_v5_exps'] : 5);        $input['fox_v5_type'] = form_select('fox_v5_type', array('credits'=>'经验', 'golds'=>'金币', 'rmbs'=>'RMB', ), !empty($get_luckdraw['fox_v5_type']) ? $get_luckdraw['fox_v5_type'] : 'golds');        $input['fox_v6_name'] = form_text('fox_v6_name', !empty($get_luckdraw['fox_v6_name']) ? $get_luckdraw['fox_v6_name'] : '幸运奖');        $input['fox_v6_ratio'] = form_text('fox_v6_ratio', !empty($get_luckdraw['fox_v6_ratio']) ? $get_luckdraw['fox_v6_ratio'] : 0);        $input['fox_v6_exps'] = form_text('fox_v6_exps', !empty($get_luckdraw['fox_v6_exps']) ? $get_luckdraw['fox_v6_exps'] : 1);        $input['fox_v6_type'] = form_select('fox_v6_type', array('credits'=>'经验', 'golds'=>'金币', 'rmbs'=>'RMB', ), !empty($get_luckdraw['fox_v6_type']) ? $get_luckdraw['fox_v6_type'] : 'golds');        $input['fox_v7_name'] = form_text('fox_v7_name', !empty($get_luckdraw['fox_v7_name']) ? $get_luckdraw['fox_v7_name'] : '未中奖');        $input['fox_v7_ratio'] = form_text('fox_v7_ratio', !empty($get_luckdraw['fox_v7_ratio']) ? $get_luckdraw['fox_v7_ratio'] : 0);        $input['fox_v7_exps'] = form_text('fox_v7_exps', !empty($get_luckdraw['fox_v7_exps']) ? $get_luckdraw['fox_v7_exps'] : 0);        $input['fox_v7_type'] = form_select('fox_v7_type', array('credits'=>'经验', 'golds'=>'金币', 'rmbs'=>'RMB', ), !empty($get_luckdraw['fox_v7_type']) ? $get_luckdraw['fox_v7_type'] : 'golds');        $nav_name = '抽奖设置';        $header['title'] = '抽奖设置 · ' . $plugins[$dir]['name'];        $setting['choujs'] = setting_get('choujs');        include _include(APP_PATH.'plugin/fox_luckdraw/oddfox/template/fox_setting.php');    }    elseif($method == 'POST'){                setting_set('choujs', param('choujs','', FALSE));        $post = array();        $post['fox_freenum'] = param('fox_freenum', 0);        $post['fox_spintime'] = param('fox_spintime', 0);        $post['fox_rotates'] = param('fox_rotates', 0);        $post['fox_spinnum'] = param('fox_spinnum', 0);        $post['fox_expfees'] = param('fox_expfees', 0);        $post['choujs'] = param('choujs', 0);        $post['fox_exptype'] = param('fox_exptype', 'golds');            $post['fox_v1_name'] = param('fox_v1_name');        $post['fox_v1_ratio'] = param('fox_v1_ratio', 0);        $post['fox_v1_exps'] = param('fox_v1_exps', 0);            $post['fox_v1_type'] = param('fox_v1_type', 'golds');        $post['fox_v2_name'] = param('fox_v2_name');        $post['fox_v2_ratio'] = param('fox_v2_ratio', 0);        $post['fox_v2_exps'] = param('fox_v2_exps', 0);            $post['fox_v2_type'] = param('fox_v2_type', 'golds');        $post['fox_v3_name'] = param('fox_v3_name');        $post['fox_v3_exps'] = param('fox_v3_exps', 0);        $post['fox_v3_ratio'] = param('fox_v3_ratio', 0);        $post['fox_v3_type'] = param('fox_v3_type', 'golds');        $post['fox_v4_name'] = param('fox_v4_name');        $post['fox_v4_exps'] = param('fox_v4_exps', 0);        $post['fox_v4_ratio'] = param('fox_v4_ratio', 0);            $post['fox_v4_type'] = param('fox_v4_type', 'golds');        $post['fox_v5_name'] = param('fox_v5_name');        $post['fox_v5_exps'] = param('fox_v5_exps', 0);        $post['fox_v5_ratio'] = param('fox_v5_ratio', 0);        $post['fox_v5_type'] = param('fox_v5_type', 'golds');        $post['fox_v6_name'] = param('fox_v6_name');        $post['fox_v6_exps'] = param('fox_v6_exps', 0);        $post['fox_v6_ratio'] = param('fox_v6_ratio', 0);        $post['fox_v6_type'] = param('fox_v6_type', 'golds');        $post['fox_v7_name'] = param('fox_v7_name');        $post['fox_v7_exps'] = param('fox_v7_exps', 0);        $post['fox_v7_ratio'] = param('fox_v7_ratio', 0);        $post['fox_v7_type'] = param('fox_v7_type', 'golds');        kv_cache_set('fox_luckdraw', $post);        fox_luckdraw_create_img($post);        message(0, '保存设置成功！');    }    elseif($method == 'POSTS'){                setting_set('choujs', param('choujs','', FALSE));    }}elseif($action == 'logs'){    $method != 'GET' AND message(-1, 'Forbidden');    $page = param(4, 1);    $pagesize = $conf['pagesize'];    $totalnum = fox_luckdraw_count();    $pagination = pagination(url("plugin-setting-fox_luckdraw-logs-{page}"), $totalnum, $page, $pagesize);    $list = fox_luckdraw_find(array(), array('id'=>-1), $page, $pagesize);    $header['title'] = '抽奖日志 - 幸运抽奖 - ' . $conf['sitename'];    include _include(APP_PATH.'plugin/fox_luckdraw/oddfox/template/fox_logs.php');}else{    exit('Forbidden');}    function plugin_info($plugins, $dir){    $enable_error = '请先<a href="'.url("plugin-enable-{$dir}").'" class="text-danger">开启'.$plugins[$dir]['name'].'</a>，您已将该插件禁用。';    $install_error = '请先<a href="'.url("plugin-install-{$dir}").'" class="text-danger">安装'.$plugins[$dir]['name'].'</a>，您已将该插件卸载。';    empty($plugins[$dir]['enable']) AND message(-1, $enable_error);    empty($plugins[$dir]['installed']) AND message(-1, $install_error);}?>